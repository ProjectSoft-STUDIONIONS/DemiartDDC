window.HELPER={pack:function(e){return JSON.stringify(e)},unpack:function(e){try{return JSON.parse(e)}catch(e){return null}},isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)&&!this.isString&&!this.isBoolean&&!this.isObject&&!this.isArray},isArray:function(e){return!this.isNull(e)&&"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return!this.isEmpty(e)&&"object"==typeof e},isBoolean:function(e){return"boolean"==typeof e},isString:function(e){return"string"==typeof e},isNull:function(e){return void 0===e||null===e},isEmpty:function(e){return this.isNull(e)||void 0!==e.length&&0==e.length}},window.OPTIONS={get:function(e,t,n){var a=void 0===localStorage[e]||"null"==typeof localStorage[e]?HELPER.pack(t):localStorage[e];switch(a=null==HELPER.unpack(a)?t:HELPER.unpack(a),n){case"number":(HELPER.isNull(a)||HELPER.isEmpty(a))&&(a=0),HELPER.isNumber(a)||(a=parseFloat(a)),this.set(e,a);break;case"boolean":a=HELPER.isBoolean(a)?a:!!t,this.set(e,a);break;case"object":case"array":a=HELPER.isObject(a)||HELPER.isArray(a)?a:"array"==n?[]:{},this.set(e,a);break;default:this.set(e,a)}return a},set:function(e,t){t=HELPER.pack(t),localStorage[e]=t}},function(e,t){Math.inInterval=Math.inInterval||function(e,t,n){return Math.min(n,Math.max(t,e))};var n=!1;const a=function(e,t=""){let n=chrome.i18n.getMessage(e);return""==n?t:n},i=function(){let t=parseFloat(s.min),n=parseFloat(s.max);parseFloat(s.value);s.volume=c.value,c.setAttribute("style",`--background-range: ${parseInt(100*s.volume)}%`),e.getElementById("range").setAttribute("range",parseInt(100*s.volume)),o(!1)},l=function(e){switch(e.type){case"play":case"waiting":case"playing":d.classList.add("play");break;case"ended":case"abort":case"emptied":case"error":case"pause":d.classList.remove("play")}},o=function(e=!1){e&&(n=!0),e&&(OPTIONS.set("INTERVAL",r.value),OPTIONS.set("AUDIO_CHECKBOX",u.checked),OPTIONS.set("SOUNDS",m.value),OPTIONS.set("AUDIO_VOLUME",c.value),OPTIONS.set("TAB_CHECKBOX",p.checked),OPTIONS.set("DEMICOLOR_CHECKBOX",g.checked),n&&chrome.runtime.sendMessage(chrome.i18n.getMessage("@@extension_id"),{message:"OPTIONS",interval:parseFloat(r.value),audiocheck:u.checked,sounds:m.value,volume:parseFloat(c.value),tab:p.checked,demicolor:g.checked},{},function(){}),n=!0)},s=new Audio,r=e.getElementById("interval"),c=e.getElementById("audio_volume"),u=e.getElementById("audio_checkbox"),d=e.getElementById("playButton"),m=e.getElementById("sounds"),p=e.getElementById("tab_checkbox"),g=e.getElementById("demicolor_checkbox"),E=e.getElementById("save"),O=e.getElementById("year");s.controls=!1,s.style.display="none",s.crossOrigin="anonymous",s.preload="none",["emptied","ended","waiting","ended","play","playing","pause","abort"].forEach(function(e,t,n){s.addEventListener(e,l)}),E.innerHTML=a("save","Сохранить"),E.addEventListener("click",function(){o(!0),setTimeout(function(){t.close()},500)}),d.addEventListener("click",function(e){d.classList.contains("play")||(d.classList.add("play"),s.src=chrome.runtime.getURL(m.options[m.selectedIndex].value),s.currentTime=0,s.play())}),e.getElementById("nameext").innerHTML=a("name"),e.getElementById("param-02-title").innerHTML=a("title02"),e.getElementById("param-03-title").innerHTML=a("title03"),e.getElementById("param-04-title").innerHTML=a("title04"),e.getElementById("param-05-title").innerHTML=a("title05"),e.getElementById("param-06-title").innerHTML=a("title06");for(let t=0;t<=25;++t){let n=`alarm${t}`,i=`/sound/${n}.ogg`,l=e.createElement("option");l.value=i,l.innerHTML=a(n,"Звук №"+(t+1)),m.append(l)}for(let e=0;e<=r.options.length-1;++e)r.options[e].innerHTML=a("option02_"+e,"Option "+(e+1));c.addEventListener("input",function(e){s.volume=parseFloat(this.value),i()}),c.addEventListener("change",function(e){s.volume=parseFloat(this.value),i()}),c.addEventListener("mousewheel",function(e){let t=e.wheelDelta,n=parseFloat(this.min),a=parseFloat(this.max),l=parseFloat(this.value),o=parseFloat(this.step);this.value=Math.inInterval(l+(t>0?o:-o),n,a),s.volume=parseFloat(this.value),i()}),m.addEventListener("change",function(e){d.classList.add("play"),s.src=chrome.runtime.getURL(m.options[m.selectedIndex].value),s.currentTime=0,s.play()}),r.value=OPTIONS.get("INTERVAL",.1666666666666667,"number"),u.checked=OPTIONS.get("AUDIO_CHECKBOX",!0,"boolean"),m.value=OPTIONS.get("SOUNDS","/sound/alarm0.ogg","string"),c.value=OPTIONS.get("AUDIO_VOLUME",.5,"number"),p.checked=OPTIONS.get("TAB_CHECKBOX",!0,"boolean"),g.checked=OPTIONS.get("DEMICOLOR_CHECKBOX",!0,"boolean"),O.innerHTML=OPTIONS.get("YEAR",(new Date).getFullYear(),"number"),i(),console.log("%c Demiart DDC && DemiartColor Code ","background:#4C5D55;color:#e7aa11;font-size:40px;")}(document,window);